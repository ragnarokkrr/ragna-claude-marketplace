# CLAUDE.md

This file provides guidance to Claude Code when working with this repository.

## Project Overview

This is a local Claude Code marketplace hosting plugins for RagnaRokkrr integration. The marketplace enables distribution and installation of custom Claude Code plugins within the organization.

## Repository Structure

```
ragna-claude-marketplace/           # Marketplace root
├── .claude-plugin/
│   └── marketplace.json           # Marketplace manifest
├── .spec/                         # Architecture documentation (examples/tests)
│   └── architecture/
│       ├── application-architecture.md
│       └── adrs/                  # Architecture Decision Records
├── ragna-claude-plugins/          # Primary plugin
│   ├── .claude-plugin/
│   │   └── plugin.json           # Plugin manifest
│   ├── agents/                   # Specialized agents
│   ├── commands/                 # Slash commands
│   ├── skills/                   # Reusable skills
│   └── hooks/                    # Event hooks
├── CLAUDE.md                     # This file
└── README.md                     # User-facing documentation
```

## Marketplace Configuration

### marketplace.json Structure

The `.claude-plugin/marketplace.json` file defines:
- Marketplace metadata (name, owner, description)
- Available plugins with their sources
- Plugin metadata (description, version, keywords)

### Adding New Plugins

To add a new plugin to the marketplace:

1. Create plugin directory structure under marketplace root
2. Add plugin entry to `.claude-plugin/marketplace.json`:
   ```json
   {
     "name": "new-plugin-name",
     "source": "./path/to/plugin",
     "description": "Plugin description",
     "version": "1.0.0"
   }
   ```
3. Test installation: `/plugin marketplace add /path/to/marketplace`

## Plugin Development Guidelines

### Component Organization

Each plugin should contain:
- **Agents** (`agents/*.md`): Specialized subagents with specific capabilities
- **Commands** (`commands/*.md`): Slash commands that expand into prompts
- **Skills** (`skills/*/SKILL.md`): Reusable capabilities for agents
- **Hooks** (`hooks/hooks.json`): Event-driven automation

### File Naming Conventions

- **Agents**: `kebab-case-name.md` with YAML frontmatter
- **Commands**: `command-name.md` or `namespace.command-name.md`
- **Skills**: Directory name is skill name, contains `SKILL.md`
- **Hooks**: Single `hooks.json` file per plugin

### Frontmatter Requirements

**Agents:**
```yaml
---
name: agent-name
description: |
  Multi-line description
model: inherit  # or sonnet, opus, haiku
color: blue     # optional
tools: Tool1, Tool2  # optional
---
```

**Commands:**
```yaml
---
description: Command description
---
```

**Skills:**
```yaml
---
name: skill-name
description: Skill description
allowed-tools: ["Tool1", "Tool2"]  # optional
---
```

## Available Agents (ragna-claude-plugins)

The primary plugin `ragna-claude-plugins` provides the following specialized agents:

### Architecture & Design
- **backend-architect** - Senior backend architect for scalable service design with arc42 documentation, C4/UML/ER diagrams, and ADRs
- **kubernetes-engineer** - Kubernetes deployment specialist with k3s support, manifest generation, Helm charts, and GitOps patterns

### Database Specialists
- **mongodb-pro** - MongoDB expert for document modeling, aggregation pipelines, indexing, sharding, and performance optimization
- **sql-pro** - SQL specialist across PostgreSQL, MySQL, SQL Server, Oracle with focus on query optimization and schema design

### Application Development
- **spring-boot-engineer** - Spring Boot 3+ engineer leveraging JDK 24+ features (virtual threads, structured concurrency) for cloud-native microservices

For detailed agent documentation, see `ragna-claude-plugins/CLAUDE.md` and individual agent files in `ragna-claude-plugins/agents/`.

## Testing Plugins

### Local Testing Workflow

1. **Validate Plugin Structure:**
   ```bash
   cd ragna-claude-plugins
   claude plugin validate .
   ```

2. **Install from Local Marketplace:**
   ```bash
   /plugin marketplace add /home/npadilha/prj/ragna-claude-marketplace
   /plugin install ragna-claude-plugins
   ```

3. **Test Components:**
   - Commands: `/command-name`
   - Agents: Use Task tool with appropriate subagent type
   - Skills: Invoke during conversation
   - Hooks: Trigger events (submit prompt, use tools)

### Debugging

- Use `/plugin list` to see installed plugins
- Use `/plugin show plugin-name` for details
- Check Claude Code logs for hook execution
- Validate JSON with `jq` or similar tools

## Architecture Documentation

The `.spec/architecture/` directory contains:
- **application-architecture.md**: Sample arc42 architecture document
- **adrs/**: Architecture Decision Records (ADR-0001 through ADR-0005)

These are examples generated by the `backend-architect` agent and serve as:
- Reference implementations for agent output
- Test cases for documentation generation
- Templates for actual project architectures

## Git Workflow

### Branch Strategy

- `master`: Stable releases
- Feature branches: `feature/description`
- Agent branches: `agent/agent-name` for new agents

### Commit Guidelines

- Use descriptive commit messages
- Reference issue numbers when applicable
- Include component type in message: `[agent]`, `[command]`, `[skill]`, `[hook]`

Example:
```
[agent] Add database-architect agent for schema design

Implements PostgreSQL-focused schema design agent with:
- ER diagram generation
- Migration script creation
- Normalization recommendations
```

## RagnaRokkrr Integration Context

This marketplace specifically targets RagnaRokkrr integration. When developing components:
- Consider RagnaRokkrr's architecture and workflows
- Align agent capabilities with RagnaRokkrr's technical stack
- Use domain-specific terminology and patterns
- Reference RagnaRokkrr documentation in command prompts

## Best Practices

### Agent Development

1. **Clear Scope**: Define specific, focused responsibilities
2. **Comprehensive Instructions**: Include workflows, examples, templates
3. **Output Format**: Specify file locations, structure, diagram types
4. **Tool Selection**: Limit tools to what's necessary
5. **Model Selection**: Use `inherit` unless specific model needed

### Command Development

1. **Parameter Handling**: Document expected arguments
2. **Error Cases**: Handle missing or invalid inputs
3. **Output Clarity**: Provide clear success/failure messages
4. **Context Preservation**: Reference conversation history when needed

### Skill Development

1. **Single Responsibility**: Each skill does one thing well
2. **Reusability**: Design for use across multiple contexts
3. **Documentation**: Clear purpose and usage instructions
4. **Tool Restrictions**: Use `allowed-tools` to limit scope

### Hook Development

1. **Minimal Side Effects**: Hooks should be fast and non-intrusive
2. **Error Handling**: Graceful failures without blocking workflow
3. **Debugging Output**: Use descriptive echo messages
4. **Security**: Validate inputs, avoid destructive commands

## Maintenance

### Regular Tasks

- Update plugin versions in `plugin.json`
- Refresh marketplace.json when plugins change
- Review and update agent instructions based on usage
- Add new ADRs for significant architectural decisions
- Keep dependencies and tool references current

### Version Management

Follow semantic versioning:
- **MAJOR**: Breaking changes to commands/agents
- **MINOR**: New features, new agents/commands
- **PATCH**: Bug fixes, documentation updates

## Resources

- [Claude Code Documentation](https://code.claude.com/docs)
- [Plugin Reference](https://code.claude.com/docs/en/plugins-reference.md)
- [Marketplace Guide](https://code.claude.com/docs/en/plugin-marketplaces.md)
- RagnaRokkrr Documentation (internal)
